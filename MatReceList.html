<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>供应商管理</title>
    <link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="easyui/themes/color.css">
    <link rel="stylesheet" type="text/css" href="easyui/themes/xyy.css">
    <link rel="stylesheet" type="text/css" href="easyui/themes/MatReceDetail.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="easyui/easyloader.js"></script>
    <script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="easyui/locale/easyui-lang-zh_CN.js"></script>
    <style>
       .messager-window{
            width: 200px !important;
            margin-left: 35% !important;
       }
       .window-shadow{
           display: none !important;
       }
       .tabs-header{
           display: none !important;
       }
       .tabs-wrap{
          display: none !important;
       }
        #dlg{
            width: 1025px !important;
            height: 400px !important;
        }
        .fitem{
            margin-top: 45px;
            margin-left: 30px;
        }
        .fitem1{
            margin-top: 45px;
            margin-left: 270px;
        }
        .fitem2{
            margin-top: 45px;
            margin-left: 270px;
        }
        .fitem3{
            margin-top: 45px;
            margin-left: 520px;
        }
       .fitem4{
            margin-left: 30px;
            margin-top: 85px;
       }
       .fitem5{
           margin-top: 60px;
           margin-left: 210px;
       }
       .fitem6{
           margin-top: 60px;
           margin-left: 460px;
       }
       .fitem7{
           margin-top: 60px;
           margin-left: 700px;
       }
       .fitem8{
           margin-top: 120px;
       }
       .fitem9{
           margin-top: 120px; 
           margin-left: 210px;
       }
       .fitem10{
           margin-top: 120px; 
           margin-left: 472px;
       }
       .fitem11{
           margin-top: 180px; 
       }
       .fitem12{
           margin-top: 120px;
       }
       .fitem13{
           margin-left: 30px;
           margin-top: 360px;
       }
       .fitem14{
           margin-top: 360px;
           margin-left: 190px;
       }
       .fitem15{
           margin-top: 360px;
           margin-left: 360px;
       }
       .fitem16{
           margin-top: 360px;
           margin-left: 520px;
       }
       .fitem17{
           margin-left: 690px;
           margin-top: 360px;
       }
       .fitem18{
           margin-top: 360px;
           margin-left: 850px;
       }
       #save{
           position: absolute;
           margin-top: 10px;
           margin-left: 30px;
           background: #19aa8d;
       }
       #closes{
           position: absolute;
           margin-top: 10px;
           margin-left: 80px;
           background: #00CDCD;
       }
    </style>
    <script type="text/javascript">
            //本页合计 
        function compute(colName) {
            var rows = $('#datagrid').datagrid('getRows');
            var total = 0;
            for (var i = 0; i < rows.length; i++) {
                if(rows[i][colName] != null){
                    total += parseFloat(rows[i][colName]);
                } 
            }
            return total;
        }
        $(function(){
            formatterDate = function(date) {
                var day = date.getDate() > 9 ? date.getDate() : "0" + date.getDate();
                var month = (date.getMonth() + 1) > 9 ? (date.getMonth() + 1) : "0"
                + (date.getMonth() + 1);
                return date.getFullYear() + '-' + month + '-' + day;
            };
            function time(number){
                var date=new Date();
                var strDate=date.getFullYear()+"-";
                if(number==0){ //0 为月底
                strDate+=date.getMonth()+2+"-";
                strDate+=number;
                }else{
                strDate+=date.getMonth()+1+"-";
                strDate+=number;
                }
                return strDate;
            }
            
            window.onload = function () {            
                $('#beginDate').datebox('setValue',time(1));
                $('#endDate').datebox('setValue', formatterDate(new Date()));
            }
            $('#datagrid').datagrid({
                onLoadSuccess: function (data) {  
                    if (data.rows.length > 0) {
                        //调用mergeCellsByField()合并单元格
                        mergeCellsByField("datagrid",  "rnNo");
                    }
                    var rdInNum = compute("rdInNum");
                    var preNum = compute("preNum");
                    var showUnit = '本页合计';
                    var showUnit1 = '总合计';
                    $('#datagrid').datagrid('appendRow', { 
                        showUnit: showUnit1,
                        rdInNum: rdInNumTotal,
                        preNum: sumPreNum,                          
                    });
                    $('#datagrid').datagrid('appendRow', {
                        showUnit: showUnit,
                        rdInNum: rdInNum,
                        preNum: preNum,   
                    });
                    var rows = $('#datagrid').datagrid('getRows');
                    // $("#datagrid").datagrid('freezeRow', rows.length - 2);
                    // $("#datagrid").datagrid('freezeRow', rows.length - 1);
                },
                onClickRow: function (rowIndex, rowData) {
                    var rowData = $('#datagrid').datagrid('getSelected');
                    if(rowData.rnId == undefined){
                        $(this).datagrid('unselectRow', rowIndex);
                        return false;
                    }
                },
            });
            // alert(location.search);
            //双击行打开编辑窗体
            $('#datagrid').datagrid({
                    loadMsg: "正在加载数据",
                    onDblClickRow: function (rowIndex, rowData) { //双击行
                    if(rowData.rnId == undefined){
                        return false;
                    }
                       // alert(formatDate(rowData.chkTime))
                    $("#dlg").window("open");
                    $("#rnNo1").val(rowData.rnNo);
                  //  $("#rnDate").datebox("setValue", rowData.rnDate1);//赋值
                    $("#rnDate").datebox("setValue",$('#rnDate').datebox('options').currentText);
                    $("#AHDate").datebox("setValue",$('#AHDate').datebox('options').currentText); 
                    $("#freight").val(rowData.freight);
                    $("#driverPhone").val(rowData.driverPhone);
                    $("#plateNumbers").val(rowData.plateNumbers)
                    $("#supName1").val(rowData.supName)
                    $("#tranAddress").val(rowData.tranAddress);
                    $("#assembly").val(rowData.assembly);
                    $("#tranType").val(rowData.tranType);
                    $("#sourceType").val(rowData.sourceType);
                    $("#remark").val(rowData.remark);
                    $("#makeManName1").val(rowData.makeManName);
                    var createDate = patternDate(rowData.createDate)
                    $("#createDate").val(createDate);      
                    if($("#chkState").val() == 0){
                        $("#chkManName").val(rowData.chkManName);
                        var chkTime = patternDate(rowData.chkTime)
                        $("#chkTime").val(chkTime);
                    }
                    var contractNo = rowData.contractNo;
                    var supid = getParameter("supid");
                    var begin = $('#beginDate').datebox('getValue');
                    var beginDate = (begin.replace(/-/g,""));
                    var end = $('#endDate').datebox('getValue');
                    var endDate = (end.replace(/-/g,""));
                    var rnNo = rowData.rnNo;
                    //alert(rnNo);
                    var itemNo = rowData.itemNo;
                    $.ajax({
                        url:'http://192.168.16.198:8866/erp/ReceiptNotice/GetReceiptList?supid='+ supid +'&itemNo=%20&itemSize=%20&makeManName=%20&rnNo='+ rnNo +'&pageIndex=1&pageSize=50&contractNo=%20&itemName=%20&beginDate='+ beginDate +'&endDate='+ endDate +'&chkState=99&closeState=99&isCancel=99',
                        type:'get',
                        success: function (data) {
                            // alert("ok");
                                var obj = {"total":data.Data.list.length,"rows":data.Data.list};   
                                $('#datagrid1').datagrid('loadData',obj);
                            },
                            error: function (e) {
                                $.messager.alert({
                                title : '提示信息!',
                                msg : '失败!!'
                            });
                            },
                        })          
                },              
            });
            $("#datagrid1").datagrid({
            columns:
                [
                    [
                        { title: '合同号', field: 'contractNo1', width: 150, align: 'left', halign: 'center' },
                        { title: '物料名称', field: 'itemName', width: 270, align: 'left', halign: 'center' },
                        { title: '规格型号', field: 'itemSize', width: 270, align: 'left', halign: 'center' }, 
                        { title: '单位', field: 'showUnit', width: 90, align: 'center', halign: 'center' },
                        { title: '预收数量', field: 'rdInNum', width: 150, align: 'right', halign: 'center',formatter:twoNumber, editor: { type: 'numberbox', options: { precision: 2} }},  
                    ]
                ],
                onClickCell: function (rowIndex, field, value) {
                    $("#datagrid1").datagrid("beginEdit", rowIndex);
                    editIndex = rowIndex;
                },
            });
        })         
        // 格式化时间方法，结果类型 yy-mm-dd
        function patternDate(date) {
            var d = new Date(date),
                    month = '' + (d.getMonth() + 1),
                    day = '' + d.getDate(),
                    year = d.getFullYear();
        
            if (month.length < 2) month = '0' + month;
            if (day.length < 2) day = '0' + day;
            return [year, month, day].join('-');
        }
        //数值转换千分位,保留两位小数
        var twoNumber = function (val) {
            if (val == null || val == "") val = 0;
            val = parseFloat(val).toFixed(2);
            var source = String(val).split(".");//按小数点分成2部分
            source[0] = source[0].replace(new RegExp('(\\d)(?=(\\d{3})+$)', 'ig'), "$1,");//只将整数部分进行分割
            return source.join(".");//再将小数部分合并进来
        };
         //数值转换千分位,保留4位小数
         var thousandBit = function (val) {
            if (val == null || val == "") val = 0;
            val = parseFloat(val).toFixed(4);
            var source = String(val).split(".");//按小数点分成2部分
            source[0] = source[0].replace(new RegExp('(\\d)(?=(\\d{3})+$)', 'ig'), "$1,");//只将整数部分进行分割
            return source.join(".");//再将小数部分合并进来
        };       
        function getParameter(name){
        var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)"); //构建一个含有目标参数的正则表达式对象     
        var r = window.location.search.substr(1).match(reg);//匹配目标参数  
        if(r!=null) {
            return unescape(r[2]); //返回参数值  
        }
            return null;
        }
        //查询
        var rdInNumTotal = 0;
        var sumPreNum = 0;
        function select(){
            var pageIndex = $('#datagrid').datagrid('options').pageNumber;//pageNumber为datagrid的当前页码
            var pageSize = $('#datagrid').datagrid('options').pageSize;//多少条数据
            var supid = getParameter("supid")
	       // alert(supid);
            var begin = $('#beginDate').datebox('getValue');
            var beginDate = (begin.replace(/-/g,""));
            var end = $('#endDate').datebox('getValue');
            var endDate = (end.replace(/-/g,""));
            var itemSize = $("#itemSize").val();
            var makeManName = $("#makeManName").val();
            var chkState = $("#chkState").val();
            var isCancel = $("#isCancel").val();
            var closeState = $("#closeState").val();
            var itemNo = $("#itemNo").val();
            var rnNo = $("#rnNo").val();
            var contractNo = $("#contractNo").val();
            var itemName = $("#itemName").val();
            var pg = $("#datagrid").datagrid("getPager");  
                if(pg)  
                {  
                    $(pg).pagination({  
                        onBeforeRefresh:function(){  
                            //    alert('before refresh');  
                        },  
                        onRefresh:function(pageNumber,pageSize){   
                            // alert(pageNumber);
                            // alert(pageSize);
                        
                        $.ajax({    
                        url:'http://192.168.16.198:8866/erp/ReceiptNotice/GetReceiptList?supid='+ supid 
                        +'&itemNo='+ itemNo 
                        +'&itemSize='+ itemSize 
                        +'&makeManName='+ makeManName 
                        +'&rnNo='+ rnNo 
                        +'&pageIndex='+ pageIndex 
                        +'&pageSize='+ pageSize 
                        +'&contractNo='+ contractNo 
                        +'&itemName='+ itemName 
                        +'&beginDate='+ beginDate
                        +'&endDate='+ endDate 
                        +'&chkState='+ chkState 
                        +'&closeState='+ closeState
                        +'&isCancel='+ isCancel +'',
                        type:'get',
                        
                        success: function (data) {
                                var obj = {"total":data.Data.totalCount,"rows":data.Data.list};   
                                $('#datagrid').datagrid('loadData',obj);
                            },
                            error: function (e) {
                                $.messager.alert({
                                    title : '提示信息!',
                                    msg : '失败!!'
                                });
                            },
                        })
                        },  
                        onChangePageSize:function(){   
                            $.ajax({    
                            url:'http://192.168.16.198:8866/erp/ReceiptNotice/GetReceiptList?supid='+ supid 
                            +'&itemNo='+ itemNo 
                            +'&itemSize='+ itemSize 
                            +'&makeManName='+ makeManName 
                            +'&rnNo='+ rnNo 
                            +'&pageIndex='+ pageIndex 
                            +'&pageSize='+ pageSize 
                            +'&contractNo='+ contractNo 
                            +'&itemName='+ itemName 
                            +'&beginDate='+ beginDate
                            +'&endDate='+ endDate 
                            +'&chkState='+ chkState 
                            +'&closeState='+ closeState
                            +'&isCancel='+ isCancel +'',
                            type:'get',
                            
                            success: function (data) {
                                    // var da = data.Data.totalCount
                                    // alert(da);
                                    var obj = {"total":data.Data.totalCount,"rows":data.Data.list};   
                                    $('#datagrid').datagrid('loadData',obj);
                                },
                                error: function (e) {
                                    $.messager.alert({
                                        title : '提示信息!',
                                        msg : '失败!!'
                                    });
                                },
                            })
                        },  
                        onSelectPage:function(pageNumber,pageSize){  
                            var pageIndex1 = pageNumber;
                            $.ajax({    
                            url:'http://192.168.16.198:8866/erp/ReceiptNotice/GetReceiptList?supid='+ supid 
                            +'&itemNo='+ itemNo 
                            +'&itemSize='+ itemSize 
                            +'&makeManName='+ makeManName 
                            +'&rnNo='+ rnNo 
                            +'&pageIndex='+ pageIndex1 
                            +'&pageSize='+ pageSize 
                            +'&contractNo='+ contractNo 
                            +'&itemName='+ itemName 
                            +'&beginDate='+ beginDate
                            +'&endDate='+ endDate 
                            +'&chkState='+ chkState 
                            +'&closeState='+ closeState
                            +'&isCancel='+ isCancel +'',
                            type:'get',
                            
                            success: function (data) {
                                    // var da = data.Data.totalCount
                                    // alert(da);
                                    var obj = {"total":data.Data.totalCount,"rows":data.Data.list};   
                                    $('#datagrid').datagrid('loadData',obj);
                                },
                                error: function (e) {
                                    $.messager.alert({
                                        title : '提示信息!',
                                        msg : '失败!!'
                                    });
                                },
                            })
                        }  
                    });  
             } 
            $.ajax({    
             url:'http://192.168.16.198:8866/erp/ReceiptNotice/GetReceiptList?supid='+ supid 
             +'&itemNo='+ itemNo 
             +'&itemSize='+ itemSize 
             +'&makeManName='+ makeManName 
             +'&rnNo='+ rnNo 
             +'&pageIndex='+ pageIndex 
             +'&pageSize='+ pageSize 
             +'&contractNo='+ contractNo 
             +'&itemName='+ itemName 
             +'&beginDate='+ beginDate
             +'&endDate='+ endDate 
             +'&chkState='+ chkState 
             +'&closeState='+ closeState
             +'&isCancel='+ isCancel +'',
             type:'get',
             
             success: function (data) {
                    if(data.Data.Sum){
                        rdInNumTotal = data.Data.Sum.rdInNumTotal;
                        sumPreNum = data.Data.Sum.sumPreNum;
                    }
                    var obj = {"total":data.Data.totalCount,"rows":data.Data.list};   
                    $('#datagrid').datagrid('loadData',obj);
                },
                error: function (e) {
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '失败!!'
                    });
                },
            })
        }
        //复位
        function tjClear(){
            $("#closeState").val("0");
            $("#isCancel").val("0");
            $("#chkState").val("99");
            $("#itemNo").val("");
            $("#itemName").val("");
            $("#contractNo").val("");
            $("#rnNo").val("");
            $("#makeManName").val("");
            $("#itemSize").val("");   
        }
        //日期格式化YY-MM-DD
        function formatDate(date) {
            var d = new Date(date),
                    month = '' + (d.getMonth() + 1),
                    day = '' + d.getDate(),
                    year = d.getFullYear();
        
            if (month.length < 2) month = '0' + month;
            if (day.length < 2) day = '0' + day;
            return [year, month, day].join('-');
        }
        //格式化栏位
        function format_check(val, row) {
            if (val == 1)
                return "<span class='label label-success'>已审核<span>";
            else if (val == 2)
                return "<span class='label label-danger'>审核中<span>";
            else if (val == 3)
                return "<span class='label label-warning'>不通过<span>";
            else if(val == 0){
                return "<span class='label'>未审核<span>";
            }
            else {
                return "";
            }
        }
        function format_close(val, row) {
            if (val == 1)
                return "<span class='label'>关闭<span>";
            else if(val == 0){
                return "<span class='label label-success'>开启<span>";
            }
            else {
                return "";
            }
                
        }
        function myformatter(date){
			var y = date.getFullYear();
			var m = date.getMonth()+1;
			var d = date.getDate();
			return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
		}
		function myparser(s){
			if (!s) return new Date();
			var ss = (s.split('-'));
			var y = parseInt(ss[0],10);
			var m = parseInt(ss[1],10);
			var d = parseInt(ss[2],10);
			if (!isNaN(y) && !isNaN(m) && !isNaN(d)){
				return new Date(y,m-1,d);
			} else {
				return new Date();
			}
		}
        //送审
        function sendCheck(){
            var rows = $('#datagrid').datagrid('getSelections');
            var row = $('#datagrid').datagrid('getSelected');
            for (var i = 0; i < rows.length; i++) {
                if (rows[0].rnId != rows[i].rnId) {
                    $.messager.alert({
                            title : '提示信息!',
                            msg : '请选择相同的订单进行操作!!'
                        });
                    return false;
                }
            }
                if (rows.length < 1) {
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '请选择需要操作的订单！!'
                    });
                    return false;
                }
                if(row.chkState == 1){
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '已审核的订单，无法送审!'
                    });
                    return false;
                }
                if (row.chkState == 2) {    
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '审核中的订单，无法送审!'
                    });
                    return false;
                }
                var rnIds = row.rnId;
                var data1 = [rnIds];
                $.ajax({
                    type: 'POST',
                    url: 'http://192.168.16.198:8866/erp/ReceiptNotice/CheckReceipt',
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify(data1),
                    success: function (data) { //返回的结果自动放在resut里面了
                        $.messager.alert({
                            title : '提示信息!',
                            msg : '送审成功!'
                        });
                    },
                    error: function (e) {
                        $.messager.alert({
                        title : '提示信息!',
                        msg : '失败!!'
                    });
                    },
                })
        }
        //纵向合并单元格
        function mergeCellsByField(tableID, colList) {
            var contractNo = colList.split(",");
            var tTable = $("#" + tableID);
            var TableRowCnts = tTable.datagrid("getRows").length;
            var tmpA;
            var tmpB;
            var PerTxt = "";
            var CurTxt = "";
            var buyprocode = "";
            var newbuyprocode = "";
            var alertStr = "";
            for (j = contractNo.length - 1; j >= 0; j--) {
                PerTxt = "";
                buyprocode = "";
                tmpA = 1;
                tmpB = 0;
 
                for (i = 0; i <= TableRowCnts; i++) {
                    if (i == TableRowCnts) {
                        CurTxt = "";
                        newbuyprocode = "";
                    }
                    else {
                        CurTxt = tTable.datagrid("getRows")[i][contractNo[j]];
                        newbuyprocode = tTable.datagrid("getRows")[i]["buyprojectCode"];
                    }
                    if (PerTxt == CurTxt && buyprocode == newbuyprocode) {
                        tmpA += 1;
                    }
                    else {
                        tmpB += tmpA;
 
                        tTable.datagrid("mergeCells", {
                            index: i - tmpA,
                            field: contractNo[j],　　//合并字段
                            rowspan: tmpA,
                            colspan: null
                        });
                        tTable.datagrid("mergeCells", { //根据ColArray[j]进行合并
                            index: i - tmpA,
                            field: "Ideparture",
                            rowspan: tmpA,
                            colspan: null
                        });
 
                        tmpA = 1;
                    }
                    PerTxt = CurTxt;
                    buyprocode = newbuyprocode;
                }
            }
        }
        function closesd(){
            $("#dlg").window("close");
        }
        //编辑保存
        function editSave(){
            var row = $('#datagrid').datagrid('getSelected');
            var rnDate1 = formatDate($('#rnDate').datebox('getValues'));
            var AHDate1 = formatDate($('#AHDate').datebox('getValues'));
            var chkTime = formatDate($('#chkTime').val());
            var createDate = formatDate($('#createDate').val());
            var plateNumbers = $('#plateNumbers').val();
            var driverPhone = $('#driverPhone').val();    
                  
            // var rndetId = row.rndetId;
            
            var remark = $('#remark').val(); 
            var rows=$('#datagrid1').datagrid('getChecked');   //  选择要提交的数据
            var endRows = $('#datagrid1').datagrid("getRows");// 获取所有的行，并且结束掉编辑
            for(var i =0; i < endRows.length; i++){
                $('#datagrid1').datagrid('endEdit', i);
            }
            for(var i =0; i < endRows.length; i++){
                if(endRows[i].rdInNum == null){
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '请填写预收数量!!'
                    });
                    return false;
                }
            }
            var rnId = endRows[0].rnId;
            var arr = [];
            for (var i = 0, j = endRows.length; i < j; i++) {
                var obj = new Object();
                obj.rdInNum = endRows[i].rdInNum;
                obj.rndetId = endRows[i].rndetId;
                arr.push(obj);
            }
            $.ajax({    
                type:'POST',
                url:'http://192.168.16.198:8866/erp/ReceiptNotice/SaveReceipt',
                data : {"MainFormDate":{"rnDate1":rnDate1,"AHDate1":AHDate1,"chkTime":chkTime,
                "createDate":createDate,"rnId":rnId,"remark":remark,
                "plateNumbers":plateNumbers,"driverPhone":driverPhone,},
                "FormDate":arr},
                success: function (data) {
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '成功!!'
                    });
                    setTimeout(function () {
                        $("#dlg").window("close");
                    },2000);
                    
                },
                error: function (e) {
                    $.messager.alert({
                        title : '提示信息!',
                        msg : '失败!!'
                    });
                },
            })    
        }
        </script>
</head>
<body class="easyui-layout" style="margin:0 1px;background-color:#f5f5f5 !important;">   
    <div data-options="region:'center'" style="background:#fff;border:0;">
	    <div id="tb" class="easyui-tabs" data-options="tools:'#tab-tools',fit:true">
			<div title="">
		        <div class="easyui-layout" data-options="fit:true">
					<div data-options="region:'center',border:false">
						<div data-options="region:'center',border:false"></div>
                            <table id="datagrid" class="easyui-datagrid" style="width:100%;height:100%;"
                                data-options="idField:'id',rownumbers:true,pagination:true,pageSize:50,singleSelect:false,
                                collapsible:true,toolbar:'#toolbar',method:'get',showFooter:true,
                                checkOnSelect:'true',selectOnCheck:'true',fitColumns:true,autoRowHeight:false,
                                nowrap:false,showRefresh:false">
							<!---获取数据--->
							<thead>
								<tr>
                                    <!-- <th field="puOrderId" checkbox="true"></th> -->
                                    <th data-options="field:'chkState',width:80,align: 'center', halign: 'center',formatter:format_check">审核状态</th>			
                                    <th data-options="field:'closeState',width:100,align: 'center', halign: 'center',formatter:format_close">行状态</th>
                                    <th data-options="field:'rnNo',width:150,align: 'left', halign: 'center',">通知单号</th>
                                    <th data-options="field:'contractNo1',width:150,align: 'left', halign: 'center'">合同号</th>
                                    <th data-options="field:'itemNo',width:100,align: 'left', halign: 'center'">物料代码</th>
                                    <th data-options="field:'itemName',width:180,align: 'left', halign: 'center'">物料名称</th>
                                    <th data-options="field:'itemSize',width:220,align: 'left', halign: 'center'">规格型号</th>
                                    <th data-options="field:'showUnit',width:100,align: 'center', halign: 'center'">单位</th>
                                    <th data-options="field:'rdInNum',width:150,align: 'right', halign: 'center',formatter:twoNumber">数量</th>
                                    <th data-options="field:'preNum',width:150,align: 'right', halign: 'center',formatter:twoNumber">到货数量</th>
									<th data-options="field:'AHDate1',width:100,align: 'center', halign: 'center'">到货日期</th>
                                    <th data-options="field:'makeManName',width:80,align: 'center', halign: 'center'">制单人</th>
                                    <th data-options="field:'rnDate1',width:100,align: 'center', halign: 'center'">制单日期</th>       
								</tr>
                            </thead>
							</table>
							<div id="toolbar">
                                <div class="col-md-2 col-sm-6">
                                    <a class="easyui-linkbutton" iconCls="icon-ok" plain="true" onclick="sendCheck()">送审</a>
                                </div>
                                <div style="margin-top: 5px; margin-bottom: 5px;">
                                    <div class="col-md-2 col-sm-6">
                                        <div class="input-append">
                                            <span class="add-on">制单日期</span>
                                            <input type="datetime" id="beginDate" name="beginDate" data-options="editable:false,formatter:myformatter,parser:myparser" class="easyui-datebox" style="width: 100px;"/>
                                            <span class="add-on">-</span>
                                            <input type="datetime" id="endDate" name="endDate" data-options="editable:false,formatter:myformatter,parser:myparser" class="easyui-datebox" style="width: 100px;"/>
                                        
                                            <a class="easyui-linkbutton" plain="true">
                                                <span>行状态: </span>
                                                <select id="closeState" name="closeState" onchange="$('#dg').datagrid({singleSelect:(this.value==1)})" style="height: 24px;">
                                                    <option value="99">全部</option>
                                                    <option value="0" selected="selected">开启</option>
                                                    <option value="1">关闭</option>
                                                </select>
                                            </a>
                                            
                                            <a class="easyui-linkbutton" plain="true">
                                                <span>作废状态: </span>
                                                <select id="isCancel" name="isCancel" onchange="$('#dg').datagrid({singleSelect:(this.value==1)})" style="height: 24px;">
                                                    <option value="99">全部</option>
                                                    <option value="0" selected="selected">正常</option>
                                                    <option value="1">作废</option>                                                   
                                                </select>
                                            </a>

                                            <a class="easyui-linkbutton" plain="true">
                                                <span>审核状态: </span>
                                                <select id="chkState" name="chkState" onchange="$('#dg').datagrid({singleSelect:(this.value==1)})" style="height: 24px;">
                                                    <option value="99">全部</option>
                                                    <option value="0">待送审</option>
                                                    <option value="1">通过</option>
                                                    <option value="2">审核中</option>
                                                    <option value="3">不通过</option>
                                                </select>
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>物料代码:</label>
                                                <input id="itemNo" name="itemNo" class="easyui-validatebox" style="height: 18px;">
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>物料名称:</label>
                                                <input id="itemName" name="itemName" class="easyui-validatebox" style="height: 18px;">
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>合同号:</label>
                                                <input id="contractNo" name="contractNo" class="easyui-validatebox" style="height: 18px;">
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>收料通知单号:</label>
                                                <input id="rnNo" name="rnNo" class="easyui-validatebox" style="height: 18px;">
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>规格型号:</label>
                                                <input id="itemSize" name="itemSize" class="easyui-validatebox" style="height: 18px;">
                                            </a>
                                            <a class="easyui-linkbutton" plain="true">
                                                <label>制单人:</label>
                                                <input id="makeManName" name="makeManName" class="easyui-validatebox" style="height: 18px;width: 100px;">
                                            </a>
                                            <button class="easyui-linkbutton" iconCls="icon-search" plain="true"  onclick="select()"></button>
                                            <button class="easyui-linkbutton" plain="true"  onclick="tjClear()">复位</button>
                                        </div>                                                                                 
                                    </div>
                                </div>
                            </div>
						</div>
					</div>
				</div>
        </div>
        <div id="dlg" title="收料通知单编辑" class="easyui-dialog" closed="true" buttons="#dlg-buttons">
            <form id="fm" method="post" novalidate style="position: relative;">
                <div class="fitem" style="width: 200px !important;position: absolute;">
                    <label>单号:</label>
                    <input id="rnNo1" name="rnNo1" class="easyui-validatebox" readonly="readonly" style="width: 160px;">
                </div>
                <div class="fitem1" style="width: 220px !important;position: absolute;display: none;">
                    <label>单据日期:</label>
                    <input type="datetime" id="rnDate" name="rnDate" data-options="editable:false,formatter:myformatter,parser:myparser" class="easyui-datebox" style="width: 160px;"/>
                </div>
                <div class="fitem2" style="width: 220px !important;position: absolute;">
                    <label>车牌号:</label>
                    <input id="plateNumbers" name="plateNumbers" class="easyui-validatebox" style="width: 162px;">
                </div>
                <div class="fitem3" style="width: 230px !important;position: absolute;">
                    <label>司机电话:</label>
                    <input id="driverPhone" name="driverPhone" class="easyui-validatebox" style="width: 160px;">
                </div>
                <div class="fitem4" style="width: 920px !important;position: absolute;">
                    <label>备注:</label>
                    <input id="remark" name="remark" class="easyui-validatebox"style="width: 875px">
                </div>
                <div class="fitem2" style="width: 300px !important;position: absolute; display: none;">
                    <label>供应商名称:</label>
                    <input id="supName1" name="supName1" class="easyui-validatebox">
                </div>
                <div class="fitem3" style="width: 300px !important;position: absolute; display: none;">
                    <label>送货地址:</label>
                    <select id="tranAddress" name="tranAddress"style="width: 170px;height: 22px;">
                        <option value="福州生产基地" selected="selected">福州生产基地</option>
                        <option value="福州火车东站">福州火车东站</option>
                        <option value="福州马尾港">福州马尾港</option>
                        <option value="福州物流点">福州物流点</option>
                    </select>
                </div>
                <div class="fitem4" style="width: 300px !important;position: absolute; display: none;">
                    <label>运费:</label>
                    <input id="freight" name="freight" step="0.01" class="easyui-validatebox">
                </div>
                
                <div class="fitem5" style="width: 300px !important;position: absolute; display: none;">
                    <label>装货方式:</label>
                    <select id="assembly" name="assembly" style="width: 170px;height: 22px;">
                        <option value="拼车" selected="selected">拼车</option>
                        <option value="整车">整车</option>
                        <option value="盘车">盘车</option>
                    </select>
                </div>
                <div class="fitem6" style="width: 300px !important;position: absolute; display: none;">
                    <label>运输方式:</label>
                    <select id="tranType" name="tranType" style="width: 170px;height: 22px;">
                        <option value="汽运" selected="selected">汽运</option>
                        <option value="海陆联运">海陆联运</option>
                        <option value="铁路联运">铁路联运</option>
                    </select>
                </div>
                <div class="fitem7" style="width: 300px !important;position: absolute; display: none;">
                    <label>预计到货:</label>
                    <input type="datetime" id="AHDate" name="AHDate" data-options="editable:false,formatter:myformatter,parser:myparser" class="easyui-datebox" />
                </div>
                <div class="fitem8" style="width: 300px !important;position: absolute; display: none;">
                    <label>类型:</label>
                    <select id="sourceType" name="sourceType" style="width: 170px;height: 22px;">
                        <option value="1">正常</option>
                        <option value="2">补货</option>
                    </select>
                </div>            
                <div class="fitem12" style="width: 100% !important;position: absolute;">
                    <table id="datagrid1" class="easyui-datagrid" data-options="rownumbers:true,singleSelect:true" nowrap="true" style="width: 100%; height:220px;">
                    </table>
                </div>
                <div class="fitem13" style="width: 220px !important;position: absolute;">
                    <label>制单人:</label>
                    <input id="makeManName1" name="makeManName1" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div class="fitem14" style="width: 230px !important;position: absolute;">
                    <label>制单日期:</label>
                    <input id="createDate" name="createDate" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div class="fitem15" style="width: 220px !important;position: absolute;">
                    <label>修改人:</label>
                    <input id="chkManName" name="chkManName" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div class="fitem16" style="width: 230px !important;position: absolute;">
                    <label>修改日期:</label>
                    <input id="chkTime" name="chkTime" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div class="fitem17" style="width: 220px !important;position: absolute;">
                    <label>审核人:</label>
                    <input id="chkManName" name="chkManName" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div class="fitem18" style="width: 150px !important;position: absolute;">
                    <label>审核日期:</label>
                    <input id="chkTime" name="chkTime" class="easyui-validatebox" readonly="readonly" style="width: 80px;">
                </div>
                <div>
                    <button class="btn" id="save" type="button" onclick="editSave()">保存</button>
                    <button class="btn" id="closes" type="button" onclick="closesd()">取消</button>
               </div>
            </form>
        </div>
	</div> 
</body>
</html>